{"version":3,"sources":["webpack:///./src/controllers/admin/Common.ts","webpack:///./src/views/admin/textbook/Add.vue?156b","webpack:///./src/controllers/admin/textbook/Add.ts","webpack:///./src/views/admin/textbook/Add.vue"],"names":["token","window","localStorage","getItem","admin_identity","Common","sInstance","logout","clear","location","href","checkToken","errNo","InvalidToken","this","getGrade","item","data","ERR_CODE","list","getLevel","grade","getUnit","i","unit","pathname","getAllCity","getRegion","cid","getSchoolCity","getCity","sid","getSchool","getClass","type","clid","getTeacher","tid","getClassTeacher","common","instance","render","_vm","_h","$createElement","_c","_self","staticClass","attrs","_v","_m","directives","name","rawName","value","textbookForm","expression","on","$event","$$selectedVal","Array","prototype","filter","call","target","options","o","selected","map","val","_value","$set","multiple","_l","key","domProps","_s","errorMsgMap","_e","level","$refs","file","click","ref","changePic","pic","changePdf","pdf","_q","active","doubleClick","preventDefault","validateAndSubmit","errorMsg","openLB","closeLB","staticRenderFns","category","IsDefined","IsNotEmpty","message","gradeList","levelList","unitList","created","event","files","suffixName","substring","lastIndexOf","isLimitSize","size","reader","FileReader","onload","e","result","readAsDataURL","skipMissingProperties","then","length","forEach","index","error","constraints","Object","keys","property","formobj","document","getElementById","FormData","append","add","Success","$router","push","AdminTextbookAddController","components","SideNav","Lightbox","component"],"mappings":"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","file":"js/chunk-33caa369.54933fb6.js","sourcesContent":["import { Vue } from \"vue-property-decorator\";\n\nimport { CommonModel, QuizModel } from \"@/models\";\nimport { ErrorCode } from \"@/constant\";\n\ntype response = { [key: string]: unknown };\n\nclass Common extends Vue {\n  private static sInstance: Common;\n  private token = window.localStorage.getItem('adminToken') as string;\n  private admin_identity = window.localStorage.getItem('admin_identity') as string;\n\n  public static get instance(): Common {\n    if (!Common.sInstance) {\n      Common.sInstance = new Common();\n    }\n\n    return Common.sInstance;\n  }\n\n  public logout() {\n    // Cookie.delCookie(\"adminToken\", '/admin');\n    // Cookie.delCookie(\"admin_aaid\", '/admin');\n    // Cookie.delCookie(\"admin_name\", '/admin');\n    // Cookie.delCookie(\"admin_identity\", '/admin');\n    // Cookie.delCookie(\"admin_sid\", '/admin');\n    // Cookie.delCookie(\"admin_school\", '/admin');\n    // Cookie.delCookie(\"admin_authority\", '/admin');\n    window.localStorage.clear();\n\n    window.location.href = \"/admin/login\";\n  }\n\n  public checkToken(errNo: number) {\n    if (errNo === ErrorCode.InvalidToken) {\n      this.logout();\n      return;\n    }\n    return;\n  }\n\n  //取得級數\n  public async getGrade() {\n    const item: { [key: string]: string } = {\n      token: this.token,\n    }\n    const data = await CommonModel.getGrade(item) as response;\n    this.checkToken(data.ERR_CODE as number);\n    return data.list as object;\n  }\n\n  //取得該級數下的等級\n  public async getLevel(grade: string) {\n    const item: { [key: string]: string } = {\n      grade: grade,\n      token: this.token,\n    }\n    const data = await CommonModel.getLevel(item) as response;\n    this.checkToken(data.ERR_CODE as number);\n    return data.list as object;\n  }\n\n  //取得該等級下的單元\n  public async getUnit() {\n    const list: response = {};\n    for (let i = 1; i <= 25; i++) {\n      list[i] = { unit: 'Unit-'+i };\n    }\n\n    if (window.location.pathname == '/admin/quiz/question/add'\n    && (this.admin_identity == '2' || this.admin_identity == '3')\n    ) {\n      return list;\n    }\n\n    if (window.location.pathname == '/admin/quiz/question/edit'\n    && (this.admin_identity == '2' || this.admin_identity == '3')\n    ) {\n      return list;\n    }\n\n    if (window.location.pathname == '/admin/homework/question/add'\n    && (this.admin_identity == '2' || this.admin_identity == '3')\n    ) {\n      return list;\n    }\n\n    if (window.location.pathname == '/admin/homework/question/edit'\n    && (this.admin_identity == '2' || this.admin_identity == '3')\n    ) {\n      return list;\n    }\n\n    list[26] = { unit: 'Midterm Exam' };\n    list[27] = { unit: 'Final Exam' };\n    return list;\n  }\n\n  //取得所有縣市\n  public async getAllCity() {\n    const item: { [key: string]: string } = {\n      token: this.token,\n    }\n    const data = await CommonModel.getAllCity(item) as response;\n    this.checkToken(data.ERR_CODE as number);\n    return data.list as object;\n  }\n\n  //取得該縣市之鄉鎮市區\n  public async getRegion(cid: string) {\n    const item: { [key: string]: string } = {\n      cid: cid,\n      token: this.token,\n    }\n    const data = await CommonModel.getRegion(item) as response;\n    this.checkToken(data.ERR_CODE as number);\n    return data.list as object;\n  }\n\n  //取得有分校之縣市\n  public async getSchoolCity() {\n    const item: { [key: string]: string } = {\n      token: this.token,\n    }\n    const data = await CommonModel.getSchoolCity(item) as response;\n    this.checkToken(data.ERR_CODE as number);\n    return data.list as object;\n  }\n\n  //取得 權限為分校之該分校之縣市\n  public async getCity(sid: string) {\n    const item: { [key: string]: string } = {\n      sid: sid,\n      token: this.token,\n    }\n    const data = await CommonModel.getCity(item) as response;\n    this.checkToken(data.ERR_CODE as number);\n    return data.list as object;\n  }\n\n  //取得該縣市之分校\n  public async getSchool(cid: string) {\n    const item: { [key: string]: string } = {\n      cid: cid,\n      token: this.token,\n    }\n    const data = await CommonModel.getSchool(item) as response;\n    this.checkToken(data.ERR_CODE as number);\n    return data.list as object;\n  }\n\n  // 取得 該分校的班級列表\n  public async getClass(type: number, sid: string, clid: number) {\n    const item: { type: number, sid: string, clid: number, token: string } = {\n      type: type, //2全部\n      sid: sid,\n      clid: clid,\n      token: this.token,\n    }\n    const data = await QuizModel.getClass(item) as response;\n    this.checkToken(data.ERR_CODE as number);\n    return data.list as object;\n  }\n\n  // 取得 該班級的老師列表\n  public async getTeacher(type: number, clid: string, tid: number) {\n    const item: { type: number, clid: string, tid: number, token: string } = {\n      type: type, //1上架的 2全部\n      clid: clid,\n      tid: tid,\n      token: this.token,\n    }\n    const data = await QuizModel.getClassTeacher(item) as response;\n    this.checkToken(data.ERR_CODE as number);\n    return data.list as object;\n  }\n}\n\nconst common = Common.instance;\n\nexport { common as Common };\n\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"wrap\"},[_c('SideNav',{attrs:{\"currentPage\":'textbook'}}),_c('div',{staticClass:\"main\"},[_c('h1',[_vm._v(\"教材資料\")]),_c('div',{staticClass:\"btn-area\"},[_c('router-link',{staticClass:\"btn\",attrs:{\"to\":\"/admin/textbook\"}},[_c('i',{staticClass:\"fa fa-chevron-left\"}),_vm._v(\" 返回 \")])],1),_c('form',{attrs:{\"action\":\"\",\"method\":\"post\",\"name\":\"textbookForm\",\"id\":\"textbookForm\"}},[_c('div',{staticClass:\"input-box\"},[_vm._m(0),_c('select',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.textbookForm.grade),expression:\"textbookForm.grade\"}],staticClass:\"select-sty w200\",attrs:{\"name\":\"grade\"},on:{\"change\":[function($event){var $$selectedVal = Array.prototype.filter.call($event.target.options,function(o){return o.selected}).map(function(o){var val = \"_value\" in o ? o._value : o.value;return val}); _vm.$set(_vm.textbookForm, \"grade\", $event.target.multiple ? $$selectedVal : $$selectedVal[0])},_vm.getLevel]}},[_c('option',{attrs:{\"value\":\"\"}},[_vm._v(\"請選擇級數\")]),_vm._l((_vm.gradeList),function(item,key){return _c('option',{key:key,domProps:{\"value\":item.grade}},[_vm._v(_vm._s(item.grade))])})],2),(_vm.errorMsgMap['grade'] !== '')?_c('label',{staticClass:\"error\"},[_vm._v(_vm._s(_vm.errorMsgMap['grade']))]):_vm._e()]),_c('div',{staticClass:\"input-box\"},[_vm._m(1),_c('select',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.textbookForm.category),expression:\"textbookForm.category\"}],staticClass:\"select-sty w200\",attrs:{\"name\":\"category\"},on:{\"change\":function($event){var $$selectedVal = Array.prototype.filter.call($event.target.options,function(o){return o.selected}).map(function(o){var val = \"_value\" in o ? o._value : o.value;return val}); _vm.$set(_vm.textbookForm, \"category\", $event.target.multiple ? $$selectedVal : $$selectedVal[0])}}},[_c('option',{attrs:{\"value\":\"1\"}},[_vm._v(\"全部\")]),_c('option',{attrs:{\"value\":\"2\"}},[_vm._v(\"直營\")]),_c('option',{attrs:{\"value\":\"3\"}},[_vm._v(\"加盟\")])]),(_vm.errorMsgMap['category'] !== '')?_c('label',{staticClass:\"error\"},[_vm._v(_vm._s(_vm.errorMsgMap['category']))]):_vm._e()]),_c('div',{staticClass:\"input-box input-box-w\"},[_vm._m(2),_c('select',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.textbookForm.level),expression:\"textbookForm.level\"}],staticClass:\"select-sty w200\",attrs:{\"name\":\"level\"},on:{\"change\":[function($event){var $$selectedVal = Array.prototype.filter.call($event.target.options,function(o){return o.selected}).map(function(o){var val = \"_value\" in o ? o._value : o.value;return val}); _vm.$set(_vm.textbookForm, \"level\", $event.target.multiple ? $$selectedVal : $$selectedVal[0])},_vm.getUnit]}},[_c('option',{attrs:{\"value\":\"\"}},[_vm._v(\"請選擇Level\")]),_vm._l((_vm.levelList),function(item,key){return _c('option',{key:key,domProps:{\"value\":item.level}},[_vm._v(_vm._s(item.level))])})],2),(_vm.errorMsgMap['level'] !== '')?_c('label',{staticClass:\"error\"},[_vm._v(_vm._s(_vm.errorMsgMap['level']))]):_vm._e()]),_c('div',{staticClass:\"input-box input-box-w\"},[_vm._m(3),_c('select',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.textbookForm.unit),expression:\"textbookForm.unit\"}],staticClass:\"select-sty w200\",attrs:{\"name\":\"unit\"},on:{\"change\":function($event){var $$selectedVal = Array.prototype.filter.call($event.target.options,function(o){return o.selected}).map(function(o){var val = \"_value\" in o ? o._value : o.value;return val}); _vm.$set(_vm.textbookForm, \"unit\", $event.target.multiple ? $$selectedVal : $$selectedVal[0])}}},[_c('option',{attrs:{\"value\":\"\"}},[_vm._v(\"請選擇單元\")]),_vm._l((_vm.unitList),function(item,key){return _c('option',{key:key,domProps:{\"value\":item.unit}},[_vm._v(_vm._s(item.unit))])})],2),(_vm.errorMsgMap['unit'] !== '')?_c('label',{staticClass:\"error\"},[_vm._v(_vm._s(_vm.errorMsgMap['unit']))]):_vm._e()]),_c('div',{staticClass:\"input-box input-box-w\"},[_vm._m(4),_c('div',{staticClass:\"note\"},[_vm._v(\"建議尺寸 300x400，格式限jpg、png、jpeg，檔案大小限2M內\")]),_c('div',{staticClass:\"upload-img\"},[_c('div',{staticClass:\"textbook-box upload-box-sty\",on:{\"click\":function($event){return _vm.$refs.file.click()}}},[_c('input',{ref:\"file\",staticClass:\"upload-pic required\",attrs:{\"type\":\"file\",\"name\":\"pic\",\"id\":\"pic\",\"accept\":\"image/*\"},on:{\"change\":function($event){return _vm.changePic($event)}}}),_c('div',{staticClass:\"upload-click-area\",attrs:{\"id\":\"previews\"}},[_c('img',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.textbookForm.pic != ''),expression:\"textbookForm.pic != ''\"}],attrs:{\"src\":_vm.textbookForm.pic,\"alt\":\"\"}})])])]),(_vm.errorMsgMap['pic'] !== '')?_c('label',{staticClass:\"error\"},[_vm._v(_vm._s(_vm.errorMsgMap['pic']))]):_vm._e()]),_c('div',{staticClass:\"input-box input-box-w\"},[_vm._m(5),_c('div',{staticClass:\"note\"},[_vm._v(\"上傳單個檔案，格式限pdf，檔案大小限5M內\")]),_c('div',{staticClass:\"upload-form-file\"},[_c('div',{staticClass:\"form-file\"},[_c('input',{attrs:{\"type\":\"file\",\"name\":\"pdf\",\"id\":\"pdf\",\"accept\":\".pdf\"},on:{\"change\":_vm.changePdf}}),_c('i',{staticClass:\"fa fa-cloud-upload\"}),_vm._v(\" 上傳pdf檔 \")]),_c('span',{staticClass:\"file-name\",attrs:{\"id\":\"fileNameBox\"}},[_vm._v(_vm._s(_vm.textbookForm.pdf))])]),(_vm.errorMsgMap['pdf'] !== '')?_c('label',{staticClass:\"error\"},[_vm._v(_vm._s(_vm.errorMsgMap['pdf']))]):_vm._e()]),_c('div',{staticClass:\"input-box\"},[_vm._m(6),_c('div',{staticClass:\"check-list\"},[_c('label',{attrs:{\"for\":\"active_1\"}},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.textbookForm.active),expression:\"textbookForm.active\"}],staticClass:\"required\",attrs:{\"type\":\"radio\",\"name\":\"active\",\"id\":\"active_1\",\"title\":\"至少選擇一個\",\"value\":\"1\"},domProps:{\"checked\":_vm._q(_vm.textbookForm.active,\"1\")},on:{\"change\":function($event){return _vm.$set(_vm.textbookForm, \"active\", \"1\")}}}),_c('div',{staticClass:\"radio-box\"}),_c('span',[_vm._v(\"啟用\")])]),_c('label',{attrs:{\"for\":\"active_2\"}},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.textbookForm.active),expression:\"textbookForm.active\"}],staticClass:\"radio-box required\",attrs:{\"type\":\"radio\",\"name\":\"active\",\"id\":\"active_2\",\"title\":\"至少選擇一個\",\"value\":\"2\"},domProps:{\"checked\":_vm._q(_vm.textbookForm.active,\"2\")},on:{\"change\":function($event){return _vm.$set(_vm.textbookForm, \"active\", \"2\")}}}),_c('div',{staticClass:\"radio-box\"}),_c('span',[_vm._v(\"停用\")])]),(_vm.errorMsgMap['active'] !== '')?_c('label',{staticClass:\"error\"},[_vm._v(_vm._s(_vm.errorMsgMap['active']))]):_vm._e()])]),_c('div',{staticClass:\"btn-area\"},[_c('router-link',{staticClass:\"btn btn-cancel\",attrs:{\"to\":\"/admin/textbook\"}},[_c('i',{staticClass:\"fa fa-chevron-left\"}),_vm._v(\" 取消\")]),_c('div',{staticClass:\"btn btn-submit\"},[_c('i',{staticClass:\"fa fa-check\"}),_vm._v(\" 確認送出 \"),_c('input',{staticClass:\"btn\",attrs:{\"type\":\"button\",\"disabled\":_vm.doubleClick},on:{\"click\":function($event){$event.preventDefault();return _vm.validateAndSubmit()}}})])],1)])]),_c('Lightbox',{attrs:{\"message\":_vm.errorMsg,\"openLB\":_vm.openLB},on:{\"closeLightbox\":_vm.closeLB}})],1)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('label',{attrs:{\"for\":\"grade\"}},[_c('span',{staticClass:\"h-txt-red\"},[_vm._v(\"*\")]),_vm._v(\"級數\")])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('label',{attrs:{\"for\":\"category\"}},[_c('span',{staticClass:\"h-txt-red\"},[_vm._v(\"*\")]),_vm._v(\"使用分校\")])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('label',{attrs:{\"for\":\"level\"}},[_c('span',{staticClass:\"h-txt-red\"},[_vm._v(\"*\")]),_vm._v(\"Level\")])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('label',{attrs:{\"for\":\"unit\"}},[_c('span',{staticClass:\"h-txt-red\"},[_vm._v(\"*\")]),_vm._v(\"單元\")])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('label',{attrs:{\"for\":\"pic\"}},[_c('span',{staticClass:\"h-txt-red\"},[_vm._v(\"*\")]),_vm._v(\"上傳教材封面圖\")])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('label',{attrs:{\"for\":\"pdf\"}},[_c('span',{staticClass:\"h-txt-red\"},[_vm._v(\"*\")]),_vm._v(\"檔案上傳\")])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('label',{attrs:{\"for\":\"active\"}},[_c('span',{staticClass:\"h-txt-red\"},[_vm._v(\"*\")]),_vm._v(\"狀態\")])}]\n\nexport { render, staticRenderFns }","import { Component, Vue } from \"vue-property-decorator\";\nimport { IsDefined, IsNotEmpty, validate } from \"class-validator\";\n\nimport { SideNav } from \"@/layout\";\nimport { Lightbox } from \"@/components\";\nimport { ErrorCode, ErrorMessage } from \"@/constant\";\nimport { TextbookModel } from \"@/models\";\nimport { Common } from \"../Common\";\n\nexport class TextbookForm {\n  @IsDefined() @IsNotEmpty({ message: \"必填\" }) grade = \"\";\n  @IsDefined() @IsNotEmpty({ message: \"必填\" }) category = 1;\n  @IsDefined() @IsNotEmpty({ message: \"必填\" }) level = \"\";\n  @IsDefined() @IsNotEmpty({ message: \"必填\" }) unit = \"\";\n  @IsDefined() @IsNotEmpty({ message: \"必填\" }) pic = \"\";\n  @IsDefined() @IsNotEmpty({ message: \"必填\" }) pdf = \"\";\n  @IsDefined() @IsNotEmpty({ message: \"必填\" }) active = 1;\n}\n\ntype response = { [key: string]: unknown };\n\n@Component<AdminTextbookAddController>({\n  components: {\n    SideNav,\n    Lightbox\n  }\n})\nexport default class AdminTextbookAddController extends Vue {\n  /*定義data 變數 */\n  private doubleClick = false;\n  private textbookForm = new TextbookForm();\n  private token = window.localStorage.getItem(\"adminToken\") as string;\n  private gradeList: object = {};\n  private levelList: object = {};\n  private unitList: response = {};\n\n  private errorMsg = \"\";\n  private openLB = false;\n  private errNo!: number;\n\n  private errorMsgMap: { [key: string]: string } = {\n    grade: \"\",\n    category: \"\",\n    level: \"\",\n    unit: \"\",\n    pic: \"\",\n    pdf: \"\",\n    active: \"\"\n  };\n\n  private async created() {\n    this.gradeList = await Common.getGrade();\n  }\n\n  private async getLevel() {\n    this.textbookForm.level = \"\";\n    this.textbookForm.unit = \"\";\n    const grade = this.textbookForm.grade;\n    this.levelList = await Common.getLevel(grade);\n    this.unitList = {};\n  }\n\n  private async getUnit() {\n    this.textbookForm.unit = \"\";\n    for (let i = 1; i <= 25; i++) {\n      this.unitList[i] = { unit: \"Unit-\" + i };\n    }\n    this.unitList[26] = { unit: \"Midterm Exam\" };\n    this.unitList[27] = { unit: \"Final Exam\" };\n  }\n\n  private changePic(event: any) {\n    const file = event.target.files[0];\n\n    if (file) {\n      //若有上傳圖片\n      /* 限制檔案上傳型別 */\n      const suffixName = file.name.substring(file.name.lastIndexOf(\".\") + 1); // 得到檔案字尾名\n      if (\n        suffixName !== \"jpg\" &&\n        suffixName !== \"png\" &&\n        suffixName !== \"jpeg\"\n      ) {\n        this.errorMsg = \"上傳檔案只能是 jpg、png、jpeg 格式！\";\n        this.openLB = true;\n        return;\n      }\n      /* 限制檔案上傳大小 */\n      const isLimitSize = file.size / 1024 / 1024 < 2;\n      if (!isLimitSize) {\n        this.errorMsg = \"上傳檔案不能超過 2MB！\";\n        this.openLB = true;\n        return;\n      }\n      const reader = new FileReader();\n\n      reader.onload = (e: any) => {\n        this.textbookForm.pic = e.target.result;\n      };\n      reader.readAsDataURL(file);\n    }\n  }\n\n  private changePdf(event: any) {\n    const file = event.target.files[0];\n\n    if (file) {\n      /* 限制檔案上傳型別 */\n      const suffixName = file.name.substring(file.name.lastIndexOf(\".\") + 1); // 得到檔案字尾名\n      if (suffixName !== \"pdf\") {\n        this.errorMsg = \"上傳檔案只能是 pdf 格式！\";\n        this.openLB = true;\n        return;\n      }\n      /* 限制檔案上傳大小 */\n      const isLimitSize = file.size / 1024 / 1024 < 5;\n      if (!isLimitSize) {\n        this.errorMsg = \"上傳檔案不能超過 5MB！\";\n        this.openLB = true;\n        return;\n      }\n      const reader = new FileReader();\n\n      reader.onload = (e: any) => {\n        this.textbookForm.pdf = file.name;\n      };\n      reader.readAsDataURL(file);\n    }\n  }\n\n  private validateAndSubmit() {\n    validate(this.textbookForm, { skipMissingProperties: true }).then(\n      async result => {\n        if (result.length !== 0) {\n          this.errorMsgMap = {\n            //先清空error message\n            grade: \"\",\n            category: \"\",\n            level: \"\",\n            unit: \"\",\n            pic: \"\",\n            pdf: \"\",\n            active: \"\"\n          };\n          result.forEach((item, index) => {\n            const error = item.constraints as {\n              [key: string]: string;\n            };\n            Object.keys(error).forEach(key => {\n              this.errorMsgMap[item.property] = error[key]; //放入error message\n            });\n          });\n          return;\n        }\n\n        if (!this.doubleClick) {\n          this.doubleClick = true;\n\n          const formobj: HTMLFormElement = document.getElementById(\n            \"textbookForm\"\n          ) as HTMLFormElement;\n          const data = new FormData(formobj); //創建空的Formdata object\n\n          data.append(\"token\", this.token);\n\n          this.errNo = await TextbookModel.add(data);\n          Common.checkToken(this.errNo);\n          this.openLB = true;\n          this.doubleClick = false;\n          this.errorMsg = ErrorMessage[this.errNo];\n        }\n      }\n    );\n  }\n\n  private closeLB() {\n    this.openLB = false;\n    if (this.errNo === ErrorCode.Success) {\n      this.$router.push(\"/admin/textbook\");\n    }\n  }\n}\n","import { render, staticRenderFns } from \"./Add.vue?vue&type=template&id=fbcd2462&\"\nimport script from \"@/controllers/admin/textbook/Add?v=2.1?vue&type=script&lang=ts&\"\nexport * from \"@/controllers/admin/textbook/Add?v=2.1?vue&type=script&lang=ts&\"\nimport style0 from \"@/assets/css/backend.css?v=2.2?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}