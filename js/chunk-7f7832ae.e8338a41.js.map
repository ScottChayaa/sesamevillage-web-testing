{"version":3,"sources":["webpack:///./node_modules/validator/lib/isLength.js","webpack:///./src/img/login_dec02.png","webpack:///./src/img/login_dec03.png","webpack:///./src/img/login_dec01.png","webpack:///./src/views/ap/student/login/Index.vue?eea8","webpack:///./src/controllers/ap/student/login/Index.ts","webpack:///./src/views/ap/student/login/Index.vue","webpack:///./node_modules/class-validator/esm5/decorator/string/MaxLength.js"],"names":["Object","defineProperty","exports","value","default","isLength","_assertString","_interopRequireDefault","obj","__esModule","_typeof","Symbol","iterator","constructor","prototype","str","options","min","max","arguments","surrogatePairs","match","len","length","module","render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","_m","_v","directives","name","rawName","loginForm","expression","domProps","on","$event","target","composing","$set","errorMsg","form","_s","doubleClick","preventDefault","validateAndSubmit","staticRenderFns","account","password","verification","IsDefined","IsNotEmpty","MaxLength","verificationCode","uid","imgSrc","response","error","created","refreshVerificationCode","timestamp","Math","floor","Date","now","toString","random","codeItem","uniqueID","refreshCodeImg","skipMissingProperties","then","result","forEach","item","index","property","code","acc","pwd","stUserLogin","data","ERR_CODE","Success","info","window","localStorage","setItem","auth","stid","$router","push","ApStudentLoginIndexController","component","MAX_LENGTH","maxLength","validationOptions","constraints","validator","validate","args","defaultMessage","eachPrefix"],"mappings":"kHAEAA,OAAOC,eAAeC,EAAS,aAAc,CAC3CC,OAAO,IAETD,EAAQE,QAAUC,EAElB,IAAIC,EAAgBC,EAAuB,EAAQ,SAEnD,SAASA,EAAuBC,GAAO,OAAOA,GAAOA,EAAIC,WAAaD,EAAM,CAAEJ,QAASI,GAEvF,SAASE,EAAQF,GAAmV,OAAtOE,EAArD,oBAAXC,QAAoD,kBAApBA,OAAOC,SAAmC,SAAiBJ,GAAO,cAAcA,GAA2B,SAAiBA,GAAO,OAAOA,GAAyB,oBAAXG,QAAyBH,EAAIK,cAAgBF,QAAUH,IAAQG,OAAOG,UAAY,gBAAkBN,GAAiBE,EAAQF,GAGnX,SAASH,EAASU,EAAKC,GAErB,IAAIC,EACAC,GAFJ,EAAIZ,EAAcF,SAASW,GAIF,WAArBL,EAAQM,IACVC,EAAMD,EAAQC,KAAO,EACrBC,EAAMF,EAAQE,MAGdD,EAAME,UAAU,IAAM,EACtBD,EAAMC,UAAU,IAGlB,IAAIC,EAAiBL,EAAIM,MAAM,oCAAsC,GACjEC,EAAMP,EAAIQ,OAASH,EAAeG,OACtC,OAAOD,GAAOL,IAAuB,qBAARC,GAAuBI,GAAOJ,GAG7DM,EAAOtB,QAAUA,EAAQE,QACzBoB,EAAOtB,QAAQE,QAAUF,EAAQE,S,uBClCjCoB,EAAOtB,QAAU,IAA0B,gC,uBCA3CsB,EAAOtB,QAAU,IAA0B,gC,qBCA3CsB,EAAOtB,QAAU,IAA0B,gC,qFCA3C,IAAIuB,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACA,EAAG,MAAM,CAACE,YAAY,cAAc,CAACF,EAAG,MAAM,CAACE,YAAY,aAAa,CAACF,EAAG,MAAM,CAACE,YAAY,QAAQF,EAAG,OAAO,CAACG,MAAM,CAAC,OAAS,OAAO,KAAO,QAAQ,GAAK,UAAU,CAACP,EAAIQ,GAAG,GAAGR,EAAIQ,GAAG,GAAGJ,EAAG,MAAM,CAACE,YAAY,WAAW,CAACF,EAAG,MAAM,CAACE,YAAY,SAASF,EAAG,KAAK,CAACJ,EAAIS,GAAG,mBAAmBL,EAAG,MAAM,CAACE,YAAY,aAAa,CAACF,EAAG,IAAI,CAACE,YAAY,eAAeF,EAAG,QAAQ,CAACM,WAAW,CAAC,CAACC,KAAK,QAAQC,QAAQ,UAAUnC,MAAOuB,EAAIa,UAAiB,QAAEC,WAAW,sBAAsBR,YAAY,qBAAqBC,MAAM,CAAC,KAAO,OAAO,KAAO,UAAU,GAAK,UAAU,YAAc,WAAW,aAAe,OAAOQ,SAAS,CAAC,MAASf,EAAIa,UAAiB,SAAGG,GAAG,CAAC,MAAQ,SAASC,GAAWA,EAAOC,OAAOC,WAAqBnB,EAAIoB,KAAKpB,EAAIa,UAAW,UAAWI,EAAOC,OAAOzC,aAAa2B,EAAG,MAAM,CAACE,YAAY,aAAa,CAACF,EAAG,IAAI,CAACE,YAAY,eAAeF,EAAG,QAAQ,CAACM,WAAW,CAAC,CAACC,KAAK,QAAQC,QAAQ,UAAUnC,MAAOuB,EAAIa,UAAkB,SAAEC,WAAW,uBAAuBR,YAAY,qBAAqBC,MAAM,CAAC,KAAO,WAAW,KAAO,WAAW,GAAK,WAAW,YAAc,WAAW,aAAe,OAAOQ,SAAS,CAAC,MAASf,EAAIa,UAAkB,UAAGG,GAAG,CAAC,MAAQ,SAASC,GAAWA,EAAOC,OAAOC,WAAqBnB,EAAIoB,KAAKpB,EAAIa,UAAW,WAAYI,EAAOC,OAAOzC,aAAa2B,EAAG,MAAM,CAACE,YAAY,qBAAqBC,MAAM,CAAC,GAAK,YAAY,CAACH,EAAG,IAAI,CAACM,WAAW,CAAC,CAACC,KAAK,OAAOC,QAAQ,SAASnC,MAA6B,KAAtBuB,EAAIqB,SAASC,KAAaR,WAAW,yBAAyBR,YAAY,6BAA6BN,EAAIS,GAAGT,EAAIuB,GAAGvB,EAAIqB,SAASC,SAASlB,EAAG,MAAM,CAACE,YAAY,mBAAmB,CAACF,EAAG,IAAI,CAACE,YAAY,uBAAuBC,MAAM,CAAC,SAAWP,EAAIwB,aAAaR,GAAG,CAAC,MAAQ,SAASC,GAAgC,OAAxBA,EAAOQ,iBAAwBzB,EAAI0B,uBAAuB,CAAC1B,EAAIS,GAAG,UAAUL,EAAG,cAAc,CAACE,YAAY,gBAAgBC,MAAM,CAAC,GAAK,6BAA6B,CAACP,EAAIS,GAAG,WAAWL,EAAG,MAAM,CAACE,YAAY,kBAAkB,CAACN,EAAIS,GAAG,oBAAoBT,EAAIQ,GAAG,IAAI,YAChhEmB,EAAkB,CAAC,WAAa,IAAI3B,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,YAAY,eAAe,CAACF,EAAG,MAAM,CAACG,MAAM,CAAC,IAAM,EAAQ,cAA+B,WAAa,IAAIP,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,YAAY,eAAe,CAACF,EAAG,MAAM,CAACG,MAAM,CAAC,IAAM,EAAQ,cAA+B,WAAa,IAAIP,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,YAAY,mBAAmB,CAACF,EAAG,MAAM,CAACG,MAAM,CAAC,IAAM,EAAQ,e,gGCKjiB,0BAC8C,KAAAqB,QAAU,GACV,KAAAC,SAAW,GAC1B,KAAAC,aAAe,GAC9C,OAH8C,gBAAzC,OAAAC,EAAA,QAAa,OAAAC,EAAA,QAAc,OAAAC,EAAA,MAAU,K,8BACI,gBAAzC,OAAAF,EAAA,QAAa,OAAAC,EAAA,QAAc,OAAAC,EAAA,MAAU,K,+BACX,gBAA1B,OAAAF,EAAA,QAAa,OAAAC,EAAA,S,mCAClB,EAJA,GASA,yE,OAEY,EAAAR,aAAc,EACd,EAAAX,UAAY,IAAI,EAChB,EAAAqB,iBAA8C,CAClDC,IAAK,GACLC,OAAQ,IAEJ,EAAAf,SAA+C,CACnDC,KAAM,GACNe,SAAU,IAEN,EAAAC,MAAQ,G,EAiFpB,OA7F2D,oBAchD,YAAAC,QAAP,WACItC,KAAKuC,2BAGK,YAAAA,wBAAd,W,uIACSvC,KAAKuB,YAAN,OACAvB,KAAKuB,aAAc,EAEbiB,EAAYC,KAAKC,MAAMC,KAAKC,MAAQ,KAAMC,WAC1CC,EAASL,KAAKC,MAAsB,IAAhBD,KAAKK,UAAiBD,WAChD7C,KAAKiC,iBAAiBC,IAAMM,EAAYM,EAElCC,EAAW,CACbC,SAAUhD,KAAKiC,iBAAiBC,KAEpC,EAAAlC,KAAKiC,iBAA0B,GAAM,OAAagB,eAAeF,K,OAAjE,EAAsBZ,OAAS,SAC/BnC,KAAKuB,aAAc,E,mCAIb,YAAAE,kBAAd,W,+GACI,eAASzB,KAAKY,UAAW,CAAEsC,uBAAuB,IAAQC,MACtD,SAAMC,GAAM,kD,kFACR,OAAsB,IAAlBA,EAAOxD,QACD,EAAyC,CAC3C+B,QAAS,KACTC,SAAU,KACVC,aAAc,OAGlB7B,KAAKoB,SAASC,KAAO,MACrB+B,EAAOC,SAAQ,SAACC,EAAMC,GAClB,EAAKnC,SAASC,MAAmB,IAAVkC,EAAe,EAAYD,EAAKE,UAAY,MAAQ,EAAYF,EAAKE,aAEhG,MAGJxD,KAAKoB,SAASC,KAAO,GAEhBrB,KAAKuB,YAAN,OACAvB,KAAKuB,aAAc,EAEF,CACbkC,KAAMzD,KAAKY,UAAUiB,aACrBmB,SAAUhD,KAAKiC,iBAAiBC,KAY9BoB,EAAO,CACTI,IAAK1D,KAAKY,UAAUe,QACpBgC,IAAK3D,KAAKY,UAAUgB,UAEX,GAAM,OAAagC,YAAYN,M,OAAtCO,EAAO,SACTA,EAAKC,WAAa,OAAUC,SACtB,EAAOF,EAAKG,KAElBC,OAAOC,aAAaC,QAAQ,eAAgBN,EAAKO,MACjDH,OAAOC,aAAaC,QAAQ,eAAgB,EAAKE,MACjDJ,OAAOC,aAAaC,QAAQ,eAAgB,EAAKzD,MAEjDV,KAAKuB,aAAc,EACnBvB,KAAKsE,QAAQC,KAAK,sBAElBvE,KAAKoB,SAASC,KAAO,OAAawC,EAAKC,UACvC9D,KAAKuC,0BACLvC,KAAKuB,aAAc,G,gDAvFtBiD,EAA6B,gBADjD,QACoBA,GA6FrB,EA7FA,CAA2D,QAAtC,I,wBCPjBC,EAAY,eACd,EACA3E,EACA4B,GACA,EACA,KACA,KACA,MAIa,aAAA+C,E,2CCnBf,uEAEWC,EAAa,YAKjB,SAASC,EAAUnG,EAAOe,GAC7B,MAAwB,kBAAVf,GAAsB,IAAkBA,EAAO,CAAEc,IAAK,EAAGC,IAAKA,IAMzE,SAASyC,EAAUzC,EAAKqF,GAC3B,OAAO,eAAW,CACdlE,KAAMgE,EACNG,YAAa,CAACtF,GACduF,UAAW,CACPC,SAAU,SAAUvG,EAAOwG,GAAQ,OAAOL,EAAUnG,EAAOwG,EAAKH,YAAY,KAC5EI,eAAgB,gBAAa,SAAUC,GAAc,OAAOA,EAAa,uEAAyEN,KAEvJA","file":"js/chunk-7f7832ae.e8338a41.js","sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = isLength;\n\nvar _assertString = _interopRequireDefault(require(\"./util/assertString\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\n/* eslint-disable prefer-rest-params */\nfunction isLength(str, options) {\n  (0, _assertString.default)(str);\n  var min;\n  var max;\n\n  if (_typeof(options) === 'object') {\n    min = options.min || 0;\n    max = options.max;\n  } else {\n    // backwards compatibility: isLength(str, min [, max])\n    min = arguments[1] || 0;\n    max = arguments[2];\n  }\n\n  var surrogatePairs = str.match(/[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]/g) || [];\n  var len = str.length - surrogatePairs.length;\n  return len >= min && (typeof max === 'undefined' || len <= max);\n}\n\nmodule.exports = exports.default;\nmodule.exports.default = exports.default;","module.exports = __webpack_public_path__ + \"img/login_dec02.5b60ecea.png\";","module.exports = __webpack_public_path__ + \"img/login_dec03.95b126e1.png\";","module.exports = __webpack_public_path__ + \"img/login_dec01.0843a6cb.png\";","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('div',{staticClass:\"login-page\"},[_c('div',{staticClass:\"login-box\"},[_c('div',{staticClass:\"box\"}),_c('form',{attrs:{\"method\":\"post\",\"name\":\"login\",\"id\":\"login\"}},[_vm._m(0),_vm._m(1),_c('div',{staticClass:\"l-login\"},[_c('div',{staticClass:\"logo\"}),_c('h1',[_vm._v(\"芝蔴街e學園 學生登入平台\")]),_c('div',{staticClass:\"input-box\"},[_c('i',{staticClass:\"fa fa-user\"}),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.loginForm.account),expression:\"loginForm.account\"}],staticClass:\"input-sty required\",attrs:{\"type\":\"text\",\"name\":\"account\",\"id\":\"account\",\"placeholder\":\"Username\",\"autocomplete\":\"off\"},domProps:{\"value\":(_vm.loginForm.account)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.$set(_vm.loginForm, \"account\", $event.target.value)}}})]),_c('div',{staticClass:\"input-box\"},[_c('i',{staticClass:\"fa fa-lock\"}),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.loginForm.password),expression:\"loginForm.password\"}],staticClass:\"input-sty required\",attrs:{\"type\":\"password\",\"name\":\"password\",\"id\":\"password\",\"placeholder\":\"Password\",\"autocomplete\":\"off\"},domProps:{\"value\":(_vm.loginForm.password)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.$set(_vm.loginForm, \"password\", $event.target.value)}}})]),_c('div',{staticClass:\"l-login-error-mesg\",attrs:{\"id\":\"err_msg\"}},[_c('i',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.errorMsg.form !== ''),expression:\"errorMsg.form !== ''\"}],staticClass:\"fa fa-exclamation-circle\"}),_vm._v(_vm._s(_vm.errorMsg.form))]),_c('div',{staticClass:\"l-login-btn-box\"},[_c('a',{staticClass:\"btn login-submit-btn\",attrs:{\"disabled\":_vm.doubleClick},on:{\"click\":function($event){$event.preventDefault();return _vm.validateAndSubmit()}}},[_vm._v(\"登入\")])]),_c('router-link',{staticClass:\"h-link h-mb16\",attrs:{\"to\":\"/student/login/forgetPwd\"}},[_vm._v(\"忘記密碼?\")]),_c('div',{staticClass:\"l-login-footer\"},[_vm._v(\" ©2021 芝蔴街e學園 \")]),_vm._m(2)],1)])])])])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"login_dec02\"},[_c('img',{attrs:{\"src\":require(\"@/img/login_dec02.png\")}})])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"login_dec03\"},[_c('img',{attrs:{\"src\":require(\"@/img/login_dec03.png\")}})])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"dec login_dec01\"},[_c('img',{attrs:{\"src\":require(\"@/img/login_dec01.png\")}})])}]\n\nexport { render, staticRenderFns }","import { Component, Vue } from \"vue-property-decorator\";\nimport { IsDefined, IsNotEmpty, MaxLength, validate } from \"class-validator\";\n\nimport { ErrorCode, ErrorMessage } from \"@/constant\";\nimport { AccountModel } from \"@/models\";\n\nexport class LoginForm {\n    @IsDefined() @IsNotEmpty() @MaxLength(50) account = '';\n    @IsDefined() @IsNotEmpty() @MaxLength(50) password = '';\n    @IsDefined() @IsNotEmpty() verification = '';\n}\n\ntype response = { [key: string]: unknown };\n\n@Component //不管有沒有都要寫，且必須放置於controller上方\nexport default class ApStudentLoginIndexController extends Vue {\n    /*定義data 變數 */\n    private doubleClick = false;\n    private loginForm = new LoginForm();\n    private verificationCode: { [key: string]: string } = {\n        uid: \"\",\n        imgSrc: \"\"\n    };\n    private errorMsg: { form: string; response: string } = {\n        form: \"\",\n        response: \"\"\n    };\n    private error = \"\";\n\n    public created() {\n        this.refreshVerificationCode(); //取得驗證碼圖片\n    }\n\n    private async refreshVerificationCode() {\n        if (!this.doubleClick) {\n            this.doubleClick = true;\n\n            const timestamp = Math.floor(Date.now() / 1000).toString();\n            const random = Math.floor(Math.random() * 1000).toString();\n            this.verificationCode.uid = timestamp + random;\n\n            const codeItem = {\n                uniqueID: this.verificationCode.uid\n            };\n            this.verificationCode.imgSrc = await AccountModel.refreshCodeImg(codeItem); //通過model call api回傳所需資料\n            this.doubleClick = false;\n        }\n    }\n\n    private async validateAndSubmit() {\n        validate(this.loginForm, { skipMissingProperties: true }).then(\n            async result => {\n                if (result.length !== 0) {\n                    const errorMsgMap: { [key: string]: string } = {\n                        account: \"帳號\",\n                        password: \"密碼\",\n                        verification: \"驗證碼\"\n                    };\n\n                    this.errorMsg.form = \"請填入\";\n                    result.forEach((item, index) => { //組合error 提示字 -> Invalid Account / Password / Verification Code\n                        this.errorMsg.form += (index === 0) ? errorMsgMap[item.property] : \" / \" + errorMsgMap[item.property];\n                    });\n                    return;\n                }\n\n                this.errorMsg.form = \"\";\n\n                if (!this.doubleClick) {\n                    this.doubleClick = true;\n\n                    const codeItem = {\n                        code: this.loginForm.verification,\n                        uniqueID: this.verificationCode.uid\n                    };\n\n                    // const verificationCodeErrNo = await AccountModel.verificationCodeCheck(codeItem); //呼叫api 驗證驗證碼正確性\n\n                    // if (verificationCodeErrNo !== ErrorCode.Success) {\n                    //     this.errorMsg.form = ErrorMessage[verificationCodeErrNo];\n                    //     this.doubleClick = false;\n                    //     this.refreshVerificationCode();\n                    //     return;\n                    // }\n\n                    const item = {\n                        acc: this.loginForm.account,\n                        pwd: this.loginForm.password\n                    };\n                    const data = await AccountModel.stUserLogin(item) as response;\n                    if (data.ERR_CODE === ErrorCode.Success) {\n                        const item = data.info as response;\n\n                        window.localStorage.setItem('studentToken', data.auth as string);\n                        window.localStorage.setItem('student_stid', item.stid as string);\n                        window.localStorage.setItem('student_name', item.name as string);\n\n                        this.doubleClick = false;\n                        this.$router.push(\"/student/student\");\n                    } else {\n                        this.errorMsg.form = ErrorMessage[data.ERR_CODE as number];\n                        this.refreshVerificationCode();\n                        this.doubleClick = false;\n                    }\n                }\n            }\n        );\n    }\n}","import { render, staticRenderFns } from \"./Index.vue?vue&type=template&id=e82584c4&\"\nimport script from \"@/controllers/ap/student/login/Index?v=3.0?vue&type=script&lang=ts&\"\nexport * from \"@/controllers/ap/student/login/Index?v=3.0?vue&type=script&lang=ts&\"\nimport style0 from \"@/assets/css/main.css?v=2.2?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import { buildMessage, ValidateBy } from '../common/ValidateBy';\nimport isLengthValidator from 'validator/lib/isLength';\nexport var MAX_LENGTH = 'maxLength';\n/**\n * Checks if the string's length is not more than given number. Note: this function takes into account surrogate pairs.\n * If given value is not a string, then it returns false.\n */\nexport function maxLength(value, max) {\n    return typeof value === 'string' && isLengthValidator(value, { min: 0, max: max });\n}\n/**\n * Checks if the string's length is not more than given number. Note: this function takes into account surrogate pairs.\n * If given value is not a string, then it returns false.\n */\nexport function MaxLength(max, validationOptions) {\n    return ValidateBy({\n        name: MAX_LENGTH,\n        constraints: [max],\n        validator: {\n            validate: function (value, args) { return maxLength(value, args.constraints[0]); },\n            defaultMessage: buildMessage(function (eachPrefix) { return eachPrefix + '$property must be shorter than or equal to $constraint1 characters'; }, validationOptions),\n        },\n    }, validationOptions);\n}\n//# sourceMappingURL=MaxLength.js.map"],"sourceRoot":""}